<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example 1 - Single Point · SugarKelp.jl Documentation</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="SugarKelp.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">SugarKelp.jl Documentation</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Index</a></li><li><a class="tocitem" href="functions.html">Function Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="example.html">Example 1 - Single Point</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="example.html">Example 1 - Single Point</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jagoosw/SugarKelp.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-1-Single-Point"><a class="docs-heading-anchor" href="#Example-1-Single-Point">Example 1 - Single Point</a><a id="Example-1-Single-Point-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1-Single-Point" title="Permalink"></a></h1><pre><code class="language-julia hljs">import Pkg; Pkg.activate(&quot;../&quot;)
using SugarKelp, Plots, Interpolations;pyplot();</code></pre><p>Set initial conditions and parameters</p><ul><li>t_i - start day (days since january first) - needs to have the same date referance as the forcing data</li><li>nd - number of days to run for</li><li>lat - latitude as this effects the change in day length</li><li>a<em>0,n</em>0,c_0 - initial area, nitrogen reserve and carbon reserve</li></ul><pre><code class="language-julia hljs">t_i = 1.0;nd = 600;lat = 60
a_0 = 0.1;n_0 = 0.022;c_0 = 0.3;</code></pre><p>Setting the forcing variables, these would normally be loaded from a data set but here will be generated</p><ul><li>time - day corresponding to forcing data in days since january first (year is arbitary). This <strong>must</strong> be a float rather than an integer or ODE solving library fails</li><li>temp - temperature in degrees C</li><li>no3 - nitrate concentration in mmol/m³</li><li>irr - PAR irradiance in μmol photons/m^2/s</li><li>u - water velocity in m/s</li></ul><pre><code class="language-julia hljs">time = [1:2:800;]

temp = 6 * cos.((time .- 250) .* 2 .* pi ./ 365) .+ 8
no3 = (7 .* ((cos.(time .* 2 .* pi ./ 365) .+ 1) ./ 2).^3 .+ 0.1) ./ 1000
irr = 40 .* (sin.((time .+ 15) .* pi ./ 365).^10) .+ 1
u = repeat([0.15],400);</code></pre><pre><code class="language-julia hljs">plot(layout=grid(1,3),size=(1000,250),legend=false)
plot!(time,temp,ylabel=&quot;Temp (°C)&quot;,sp=1)
plot!(time,no3,xlabel=&quot;Day&quot;,ylabel=&quot;Nitrate concentration (mmol/m³)&quot;,sp=2)
plot!(time,irr,ylabel=&quot;PAR (μmol photons/m²/s)&quot;,sp=3)</code></pre><p><img src="output_6_0.png" alt="png"/></p><p>The forcing variables must be converted to interpolations for the kelp model to access them at arbitary time</p><pre><code class="language-julia hljs">temp_itp=Interpolations.LinearInterpolation(time,temp)
no3_itp=Interpolations.LinearInterpolation(time,no3)
irr_itp=Interpolations.LinearInterpolation(time,irr)
u_itp=Interpolations.LinearInterpolation(time,u);</code></pre><p>Now the model can be run, the parameter file must be passed and in this run the resparation model proposed in Broch, 2013 is being used</p><pre><code class="language-julia hljs">solution, results = SugarKelp.solve(t_i, nd, u_itp, temp_itp, irr_itp, no3_itp, lat, a_0, n_0, c_0, &quot;../src/parameters/2013.jl&quot;,2);</code></pre><p>Solutions contains the raw output of the ODE solver while results is refactored into a dataframe (this can optionally be turned off for an array to be returned)</p><pre><code class="language-julia hljs">results</code></pre><p>&lt;div class=&quot;data-frame&quot;&gt;&lt;p&gt;601 rows × 5 columns&lt;/p&gt;&lt;table class=&quot;data-frame&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;area&lt;/th&gt;&lt;th&gt;nitrogen&lt;/th&gt;&lt;th&gt;carbon&lt;/th&gt;&lt;th&gt;gross_nitrate&lt;/th&gt;&lt;th&gt;time&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th title=&quot;Any&quot;&gt;Any&lt;/th&gt;&lt;th title=&quot;Any&quot;&gt;Any&lt;/th&gt;&lt;th title=&quot;Any&quot;&gt;Any&lt;/th&gt;&lt;th title=&quot;Any&quot;&gt;Any&lt;/th&gt;&lt;th title=&quot;Any&quot;&gt;Any&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;1&lt;/th&gt;&lt;td&gt;0.1&lt;/td&gt;&lt;td&gt;0.022&lt;/td&gt;&lt;td&gt;0.3&lt;/td&gt;&lt;td&gt;0.0&lt;/td&gt;&lt;td&gt;1.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;2&lt;/th&gt;&lt;td&gt;0.109134&lt;/td&gt;&lt;td&gt;0.0189379&lt;/td&gt;&lt;td&gt;0.267903&lt;/td&gt;&lt;td&gt;8.52351e-8&lt;/td&gt;&lt;td&gt;2.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;3&lt;/th&gt;&lt;td&gt;0.116672&lt;/td&gt;&lt;td&gt;0.0167756&lt;/td&gt;&lt;td&gt;0.247928&lt;/td&gt;&lt;td&gt;3.68739e-7&lt;/td&gt;&lt;td&gt;3.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;4&lt;/th&gt;&lt;td&gt;0.122468&lt;/td&gt;&lt;td&gt;0.0152978&lt;/td&gt;&lt;td&gt;0.237388&lt;/td&gt;&lt;td&gt;8.09489e-7&lt;/td&gt;&lt;td&gt;4.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;5&lt;/th&gt;&lt;td&gt;0.126655&lt;/td&gt;&lt;td&gt;0.014318&lt;/td&gt;&lt;td&gt;0.23388&lt;/td&gt;&lt;td&gt;1.36651e-6&lt;/td&gt;&lt;td&gt;5.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;6&lt;/th&gt;&lt;td&gt;0.129536&lt;/td&gt;&lt;td&gt;0.0136848&lt;/td&gt;&lt;td&gt;0.235377&lt;/td&gt;&lt;td&gt;2.00431e-6&lt;/td&gt;&lt;td&gt;6.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;7&lt;/th&gt;&lt;td&gt;0.131451&lt;/td&gt;&lt;td&gt;0.0132832&lt;/td&gt;&lt;td&gt;0.240287&lt;/td&gt;&lt;td&gt;2.69541e-6&lt;/td&gt;&lt;td&gt;7.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;8&lt;/th&gt;&lt;td&gt;0.132698&lt;/td&gt;&lt;td&gt;0.0130318&lt;/td&gt;&lt;td&gt;0.247446&lt;/td&gt;&lt;td&gt;3.42009e-6&lt;/td&gt;&lt;td&gt;8.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;9&lt;/th&gt;&lt;td&gt;0.133506&lt;/td&gt;&lt;td&gt;0.0128758&lt;/td&gt;&lt;td&gt;0.256043&lt;/td&gt;&lt;td&gt;4.16497e-6&lt;/td&gt;&lt;td&gt;9.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;10&lt;/th&gt;&lt;td&gt;0.134031&lt;/td&gt;&lt;td&gt;0.0127794&lt;/td&gt;&lt;td&gt;0.265536&lt;/td&gt;&lt;td&gt;4.92123e-6&lt;/td&gt;&lt;td&gt;10.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;11&lt;/th&gt;&lt;td&gt;0.134378&lt;/td&gt;&lt;td&gt;0.01272&lt;/td&gt;&lt;td&gt;0.27557&lt;/td&gt;&lt;td&gt;5.68316e-6&lt;/td&gt;&lt;td&gt;11.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;12&lt;/th&gt;&lt;td&gt;0.134615&lt;/td&gt;&lt;td&gt;0.0126834&lt;/td&gt;&lt;td&gt;0.28592&lt;/td&gt;&lt;td&gt;6.4471e-6&lt;/td&gt;&lt;td&gt;12.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;13&lt;/th&gt;&lt;td&gt;0.134782&lt;/td&gt;&lt;td&gt;0.0126608&lt;/td&gt;&lt;td&gt;0.296442&lt;/td&gt;&lt;td&gt;7.21063e-6&lt;/td&gt;&lt;td&gt;13.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;14&lt;/th&gt;&lt;td&gt;0.134907&lt;/td&gt;&lt;td&gt;0.0126468&lt;/td&gt;&lt;td&gt;0.307046&lt;/td&gt;&lt;td&gt;7.97216e-6&lt;/td&gt;&lt;td&gt;14.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;15&lt;/th&gt;&lt;td&gt;0.135005&lt;/td&gt;&lt;td&gt;0.0126382&lt;/td&gt;&lt;td&gt;0.317676&lt;/td&gt;&lt;td&gt;8.73057e-6&lt;/td&gt;&lt;td&gt;15.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;16&lt;/th&gt;&lt;td&gt;0.135087&lt;/td&gt;&lt;td&gt;0.0126328&lt;/td&gt;&lt;td&gt;0.328295&lt;/td&gt;&lt;td&gt;9.48508e-6&lt;/td&gt;&lt;td&gt;16.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;17&lt;/th&gt;&lt;td&gt;0.135158&lt;/td&gt;&lt;td&gt;0.0126295&lt;/td&gt;&lt;td&gt;0.338884&lt;/td&gt;&lt;td&gt;1.02351e-5&lt;/td&gt;&lt;td&gt;17.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;18&lt;/th&gt;&lt;td&gt;0.135223&lt;/td&gt;&lt;td&gt;0.0126274&lt;/td&gt;&lt;td&gt;0.349427&lt;/td&gt;&lt;td&gt;1.09801e-5&lt;/td&gt;&lt;td&gt;18.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;19&lt;/th&gt;&lt;td&gt;0.135284&lt;/td&gt;&lt;td&gt;0.0126261&lt;/td&gt;&lt;td&gt;0.359918&lt;/td&gt;&lt;td&gt;1.17197e-5&lt;/td&gt;&lt;td&gt;19.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;20&lt;/th&gt;&lt;td&gt;0.135342&lt;/td&gt;&lt;td&gt;0.0126253&lt;/td&gt;&lt;td&gt;0.370352&lt;/td&gt;&lt;td&gt;1.24535e-5&lt;/td&gt;&lt;td&gt;20.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;21&lt;/th&gt;&lt;td&gt;0.135398&lt;/td&gt;&lt;td&gt;0.0126248&lt;/td&gt;&lt;td&gt;0.380726&lt;/td&gt;&lt;td&gt;1.31812e-5&lt;/td&gt;&lt;td&gt;21.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;22&lt;/th&gt;&lt;td&gt;0.135452&lt;/td&gt;&lt;td&gt;0.0126244&lt;/td&gt;&lt;td&gt;0.391039&lt;/td&gt;&lt;td&gt;1.39026e-5&lt;/td&gt;&lt;td&gt;22.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;23&lt;/th&gt;&lt;td&gt;0.135506&lt;/td&gt;&lt;td&gt;0.0126242&lt;/td&gt;&lt;td&gt;0.401291&lt;/td&gt;&lt;td&gt;1.46173e-5&lt;/td&gt;&lt;td&gt;23.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;24&lt;/th&gt;&lt;td&gt;0.135559&lt;/td&gt;&lt;td&gt;0.012624&lt;/td&gt;&lt;td&gt;0.411481&lt;/td&gt;&lt;td&gt;1.5325e-5&lt;/td&gt;&lt;td&gt;24.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;25&lt;/th&gt;&lt;td&gt;0.13561&lt;/td&gt;&lt;td&gt;0.0126239&lt;/td&gt;&lt;td&gt;0.42161&lt;/td&gt;&lt;td&gt;1.60256e-5&lt;/td&gt;&lt;td&gt;25.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;26&lt;/th&gt;&lt;td&gt;0.135662&lt;/td&gt;&lt;td&gt;0.0126238&lt;/td&gt;&lt;td&gt;0.431679&lt;/td&gt;&lt;td&gt;1.67187e-5&lt;/td&gt;&lt;td&gt;26.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;27&lt;/th&gt;&lt;td&gt;0.135712&lt;/td&gt;&lt;td&gt;0.0126237&lt;/td&gt;&lt;td&gt;0.441689&lt;/td&gt;&lt;td&gt;1.74041e-5&lt;/td&gt;&lt;td&gt;27.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;28&lt;/th&gt;&lt;td&gt;0.135762&lt;/td&gt;&lt;td&gt;0.0126237&lt;/td&gt;&lt;td&gt;0.451641&lt;/td&gt;&lt;td&gt;1.80815e-5&lt;/td&gt;&lt;td&gt;28.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;29&lt;/th&gt;&lt;td&gt;0.135812&lt;/td&gt;&lt;td&gt;0.0126236&lt;/td&gt;&lt;td&gt;0.461535&lt;/td&gt;&lt;td&gt;1.87509e-5&lt;/td&gt;&lt;td&gt;29.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;30&lt;/th&gt;&lt;td&gt;0.135861&lt;/td&gt;&lt;td&gt;0.0126235&lt;/td&gt;&lt;td&gt;0.471374&lt;/td&gt;&lt;td&gt;1.94119e-5&lt;/td&gt;&lt;td&gt;30.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;&amp;vellip;&lt;/th&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;</p><p>It is useful to convert the results into total carbon and nitrogen masses (rather than the reserves that the model returns), this requires some of the parameters.</p><pre><code class="language-julia hljs">include(&quot;../src/parameters/2013.jl&quot;)
total_carbon = results.area .* K_A .* (results.carbon .+ C_struct)
total_nitrogen = results.area .* K_A .* (results.nitrogen .+ N_struct);</code></pre><pre><code class="language-julia hljs">plot(layout=grid(1,3),size=(1000,250),legend=false)
plot!(results.time,results.area,ylabel=&quot;Area/dm²&quot;,sp=1)
plot!(results.time,total_carbon,xlabel=&quot;Day&quot;,ylabel=&quot;Total Carbon (gC)&quot;,sp=2)
plot!(results.time,total_nitrogen,ylabel=&quot;Total Nitrogen (gN)&quot;,sp=3)</code></pre><p><img src="output_15_0.png" alt="png"/></p><h1 id="Example-2-Grid"><a class="docs-heading-anchor" href="#Example-2-Grid">Example 2 - Grid</a><a id="Example-2-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2-Grid" title="Permalink"></a></h1><p>For a grid we must set initial conditions as with a single point</p><pre><code class="language-julia hljs">t_i = 1.0;nd = 300
a_0 = 0.1;n_0 = 0.022;c_0 = 0.3;</code></pre><p>This time we will generate a 4d grid of input data for temp and no3 and 2d for nitrate. An aditional variable needs to be generated, either a 3d diffuse attenuation coefficient or 4d light attenuation. In this example the latter is used. Again this would usually be loaded from a file. It is benefitial to define all of these as constants as it drastically speeds up on larger grids.</p><pre><code class="language-julia hljs">const arr_lon=[45:50;]
const arr_lat=[55:65;]
const arr_dep=[0:5:75;]
const arr_t = [0:2:310;]

const arr_temp = permutedims(repeat(6 * cos.((arr_t .- 250) .* 2 .* pi ./ 365) .+ 8,1,length(arr_lon),length(arr_lat),length(arr_dep)),(2,3,4,1)).*permutedims(repeat(arr_lat./arr_lat[1],1,length(arr_lon),length(arr_dep),length(arr_t)),(2,1,3,4))
const arr_no3 = permutedims(repeat((7 .* ((cos.(arr_t .* 2 .* pi ./ 365) .+ 1) ./ 2).^3 .+ 0.1) ./ 1000,1,length(arr_lon),length(arr_lat),length(arr_dep)),(2,3,4,1)).*repeat(arr_lon./arr_lon[1],1,length(arr_lat),length(arr_dep),length(arr_t))
const arr_irr = permutedims(repeat(40 .* (sin.((arr_t .+ 15) .* pi ./ 365).^10) .+ 1,1,length(arr_lon),length(arr_lat)),(2,3,1)).*permutedims(repeat(arr_lat./arr_lat[1],1,length(arr_lon),length(arr_t)),(2,1,3))
const arr_beta = permutedims(repeat(reverse([0:1/(length(arr_dep)-1):1;]),1,length(arr_lon),length(arr_lat),length(arr_t)),(2,3,1,4))
const arr_u = permutedims(repeat([0.15],length(arr_t),length(arr_lon),length(arr_lat),length(arr_dep)),(2,3,4,1));</code></pre><p>These grids are directly fed to the grid solver, which returns an array. irr can have its own time provided as satellite products often do not have the same temporal resolution as models. Additionally a fill value, in this case NaN, can be provided as they are often temporally sparse and need to be filtered.</p><p>This function automatically paralalises to however many threads you start julia with</p><pre><code class="language-julia hljs">@time results = SugarKelp.solvegrid(t_i, nd, a_0, n_0, c_0, arr_lon, arr_lat, arr_dep, arr_t, arr_no3, arr_temp, arr_u, (arr_irr, arr_t, NaN), (nothing, nothing, nothing), arr_beta, &quot;../src/parameters/2013.jl&quot;, 2);</code></pre><pre><code class="nohighlight hljs">┌ Info: At level 1
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 2
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 3
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 4
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 5
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 6
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 7
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 8
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 9
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 10
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 11
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 12
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 13
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 14
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 15
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337
┌ Info: At level 16
└ @ SugarKelp /home/jago/Documents/Projects/SugarKelp.jl/src/SugarKelp.jl:337


 32.622805 seconds (135.82 M allocations: 4.460 GiB, 2.42% gc time, 25.27% compilation time)</code></pre><p>The output from this is an array with area/nitrogen reserve/carbon reserve/nitrate uptake in the first dimention, then lon,lat,dep,time in the others. We can extract the total carbon and nitrogen again:</p><pre><code class="language-julia hljs">total_carbon = results[1,:,:,:,:] .* K_A .* (results[3,:,:,:,:] .+ C_struct)
total_nitrogen = results[1,:,:,:,:] .* K_A .* (results[2,:,:,:,:] .+ N_struct);</code></pre><p>We could plot these for a couple of points as a comparison for above:</p><pre><code class="language-julia hljs">plot(layout=grid(1,3),size=(1000,300))
results_time=[0:nd;]
for r=1:10
    i,j,k=rand([1:length(arr_lon);]),rand([1:length(arr_lat);]),rand([1:length(arr_dep);])
    plot!(results_time,results[1,i,j,k,:],sp=1,label=&quot;$(arr_lat[j])N, $(arr_lon[i])W, $(arr_dep[k])m&quot;)
    plot!(results_time,total_carbon[i,j,k,:],sp=2)
    plot!(results_time,total_nitrogen[i,j,k,:],sp=3)
end
plot!(ylabel=&quot;Area/dm²&quot;,sp=1,legend=:bottomright);plot!(sp=2,xlabel=&quot;Day&quot;,ylabel=&quot;Total Carbon (gC)&quot;,legend=false);plot!(sp=3,ylabel=&quot;Total Nitrogen (gN)&quot;,legend=false)</code></pre><p><img src="output_26_0.png" alt="png"/></p><p>Or we could plot a heatmap of the surfaces:</p><pre><code class="language-julia hljs">hms=[
    heatmap(arr_lon,arr_lat,total_carbon[:,:,1,end]&#39;,color=cgrad(:bamako, rev=true),colorbar_title=&quot;Total Carbon (gC)&quot;),
    heatmap(arr_lon,arr_lat,total_nitrogen[:,:,1,end]&#39;,color=:lajolla,colorbar_title=&quot;Total Nitrogen (gN)&quot;),
    heatmap(arr_lon,arr_lat,total_carbon[:,:,1,end]&#39;./total_nitrogen[:,:,1,end]&#39;,color=cgrad(:lapaz, rev=true),colorbar_title=&quot;Carbon:Nitrogen ratio&quot;)
]
plot!(hms...,layout=grid(1,3),size=(1000,200))</code></pre><p><img src="output_28_0.png" alt="png"/></p><pre><code class="language-julia hljs"></code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.7 on <span class="colophon-date" title="Tuesday 12 October 2021 10:51">Tuesday 12 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
