<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function Documentation · SugarKelp.jl Documentation</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="SugarKelp.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">SugarKelp.jl Documentation</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Index</a></li><li class="is-active"><a class="tocitem" href="functions.html">Function Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="functions.html">Function Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="functions.html">Function Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jagoosw/SugarKelp.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-Documentation"><a class="docs-heading-anchor" href="#Function-Documentation">Function Documentation</a><a id="Function-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.equations-NTuple{10, Any}" href="#Main.SugarKelp.equations-NTuple{10, Any}"><code>Main.SugarKelp.equations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.equations(t, a, n, c, u, temp, irr, ex_n, λ, resp_model, dt)</code></pre><p>Solves the papers main equations.</p><p>Parameters:</p><ul><li><code>a</code>: area /dm^2</li><li><code>n</code>: nitrate reserve /gN/gSW</li><li><code>c</code>: carbon reserve /gC/gSW</li><li><code>u</code>: water speed /m/s</li><li><code>temp</code>: temperature /°C</li><li><code>irr</code>: irradiance / mol photons/m²/day</li><li><code>ex_n</code>: external nitrate concentration /mmol m^3</li><li><code>λ</code>: normalised change in day length</li><li><code>resp_model</code>: choice of resparation model (see SugarKelp.r)</li><li><code>dt</code>: timestep length /days</li></ul><p>Returns:</p><ul><li><code>da</code>: results of equation 1, the area rate</li><li><code>dn</code>: results of equation 7, the nitrogen rate</li><li><code>dc</code>: results of equation 9, the carbon rate</li><li><code>j</code>: the specific nitrate uptake rate</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.eval_j-Tuple{Any, Any, Any}" href="#Main.SugarKelp.eval_j-Tuple{Any, Any, Any}"><code>Main.SugarKelp.eval_j</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.eval_j(ex_n,n,u)</code></pre><p>Solves Equation 8, the specific nitrate uptake rate.</p><p>Parameters:</p><ul><li><code>ex_n</code>: external nitrate concentration /mmol/m^3</li><li><code>n</code>: nitrogen reserve /gN/gSW</li><li><code>u</code>: water speed /m/s</li></ul><p>Returns: specific nitrate uptake rate</p><p>Notes:</p><ul><li>Names eval_j because it looks better in SugarKelp.equations to have j and you can&#39;t reuse it</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.eval_μ-NTuple{5, Any}" href="#Main.SugarKelp.eval_μ-NTuple{5, Any}"><code>Main.SugarKelp.eval_μ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.eval_μ(a,n,c,temp,λ)</code></pre><p>Solves Equation 2, the specific growth rate.</p><p>Parameters:</p><ul><li><code>a</code>: area /dm^2</li><li><code>n</code>: nitrate reserve /gN/gSW</li><li><code>c</code>: carbon reserve /gC/gSW</li><li><code>temp</code>: temperature /°C</li><li><code>λ</code>: normalised change in day length</li></ul><p>Returns: specific growth rate</p><p>Notes:</p><ul><li>Names eval_μ because it looks better in SugarKelp.equations to have μ and you can&#39;t reuse it</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.extract_valid-Tuple{Any, Any, Any}" href="#Main.SugarKelp.extract_valid-Tuple{Any, Any, Any}"><code>Main.SugarKelp.extract_valid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.extract_valid(raw,raw_time,fill)</code></pre><p>Extracts the valid values from an array by checking against a fill value and returns the valids and corresponding time.</p><p>Parameters:</p><ul><li><code>raw</code>: the array to check</li><li><code>raw_time</code>: the corresponding time array</li><li><code>fill</code>: the fill value to check against</li></ul><p>Returns:</p><ul><li><code>vals</code>: the filtered values</li><li><code>time</code>: corresponding times</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.f_area-Tuple{Any}" href="#Main.SugarKelp.f_area-Tuple{Any}"><code>Main.SugarKelp.f_area</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.f_area(a)</code></pre><p>Solves Equation 3, the effect of area on growth</p><p>Parameters: <code>a</code>, area /dm^2</p><p>Returns: effect of area on growth</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.f_photo-Tuple{Any}" href="#Main.SugarKelp.f_photo-Tuple{Any}"><code>Main.SugarKelp.f_photo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.f_photo(λ)</code></pre><p>Solves Equation 5, the seasonal influence on growth rate</p><p>Parameters: <code>λ</code>: normalised change in day length</p><p>Returns: seasonal influence on growth</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.f_temp-Tuple{Any}" href="#Main.SugarKelp.f_temp-Tuple{Any}"><code>Main.SugarKelp.f_temp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.f_temp(temp)</code></pre><p>Solves Equation 4, the effect of temperature on growth</p><p>Parameters: <code>temp</code>: temperature /°C</p><p>Returns: effect of temperature on growth</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.gen_λ-Tuple{Any}" href="#Main.SugarKelp.gen_λ-Tuple{Any}"><code>Main.SugarKelp.gen_λ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.gen_λ(lat)</code></pre><p>Generates λ as described in Model desctiptions/Main equations/Photoperiodic effect (page 763) in the origional paper.</p><p>Parameter: <code>lat</code>, the latitude</p><p>Returns: array of normalised change in day length</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.get_ind-Tuple{Any, Any, Any}" href="#Main.SugarKelp.get_ind-Tuple{Any, Any, Any}"><code>Main.SugarKelp.get_ind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.get_ind(val, list, tol)</code></pre><p>Function that finds the index in the list with the closest value to val. Error is thrown if no result is within tollerance, tol.</p><p>Parameters:</p><ul><li><code>val</code>: the value searching for</li><li><code>list</code>: the list to search</li><li><code>tol</code>: tollerance of search</li></ul><p>Returns:</p><ul><li>`index of closest valuea</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.interp_deps-NTuple{4, Any}" href="#Main.SugarKelp.interp_deps-NTuple{4, Any}"><code>Main.SugarKelp.interp_deps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.interp_deps(arr, origional_depths, desired_depths, invalid_val)</code></pre><p>Function to interpolate a 4D array in the last dimension. Useful for lineaising the depth steps of the arrays from Copurnicus as they have increasingly corse step sizes.</p><p>Parameters:</p><ul><li><code>arr</code>: the array to interpolate where the 3rd dimension is the one to interpolate along</li><li><code>origional_depths</code>: the values of the 3rd dimensions coordinates (the origional depths of the data)</li><li><code>desired_depths</code>: the desired coordinates/depths</li><li><code>invalid_val</code>: the fill value to replace with NaN in the array (as we are searching it anyway)</li></ul><p>Returns: new array with interpolated 3rd dimension</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.p-Tuple{Any, Any}" href="#Main.SugarKelp.p-Tuple{Any, Any}"><code>Main.SugarKelp.p</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.p(temp,irr)</code></pre><p>Solves Equation 10, the gross photosynthesis.</p><p>Parameters:</p><ul><li><code>temp</code>: temperature /°C</li><li><code>irr</code>: irradiance /mol photons/m²/day</li></ul><p>Returns: gross photosynthesis function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.r-NTuple{4, Any}" href="#Main.SugarKelp.r-NTuple{4, Any}"><code>Main.SugarKelp.r</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.r(temp,μ,j,resp_model)</code></pre><p>Solves Equation 14 (2012) if resp<em>model=1, or Equation 2 (2013) if resp</em>model=2</p><p>Parameters:</p><ul><li><code>temp</code>: temperature /°C</li><li><code>μ</code>: specific growth rate</li><li><code>j</code>: specific nitrate uptake rate</li><li><code>resp_model</code>: choice of resparation model (see description)</li></ul><p>Returns: respiration function</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.solve" href="#Main.SugarKelp.solve"><code>Main.SugarKelp.solve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.solve(t_i, nd, u, temp, irr, ex_n, lat, a_0, n_0, c_0, params=&quot;src/parameters/origional.jl&quot;, resp_model=1, dt=1, dataframe=true)</code></pre><p>Solves the model for some set of parametetrs and returns the ODE library solution as well as a dataframe of the useful results.</p><p>Parameters:</p><ul><li><code>t_i</code>: th estart time (in days since the start of the interpolation objects &quot;day zero&quot;)</li><li><code>nd</code>: the number of days to run for</li><li><code>u</code>: interpolation object (IO) of water speed</li><li><code>temp</code>: IO of temperature</li><li><code>ex_n</code>: IO of external nitrate concentration</li><li><code>lat</code>: latitude, relivant for the change of day length</li><li><code>a_0</code>: initial area</li><li><code>n_0</code>: initial nitrogen reserve (gN/gSW)</li><li><code>c_0</code>: initial carbon reserve (gC/gSW)</li><li><code>params</code>: string of the path to a parameters file, defaults to the 2012 values. Also supplied is 2013 in src/parameters/2013.jl or you can copy and vary them</li><li><code>resp_model</code>: choice of respiration model, 1 (default) uses the 2012 version and 2 uses the modifcations from the 2013 paper</li><li><code>dt</code>: the time step size to use (see equations! note), default is 1 day (seems small enough)</li><li><code>dataframe</code>: output as a dataframe, default to true. Alternative is an array (faster)</li><li><code>λ_arr</code>: array of normalised change of day length, defaults to nothing which generates the default one</li></ul><p>Returns:</p><ul><li><code>solution</code>: the ODE library solution</li><li><code>results</code>: dataframe or array of area/nitrogen reserve/carbon reserve/total nitrate update. All others useful quantities can be easily derived.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.solvegrid" href="#Main.SugarKelp.solvegrid"><code>Main.SugarKelp.solvegrid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.solvegrid(t_i, nd, a_0, n_0, c_0, arr_lon, arr_lat, arr_dep, arr_time, no3, temp, u, par_data, kd_data, att = nothing, params=&quot;src/parameters/origional.jl&quot;, resp_model=1, dt=1, progress=true)</code></pre><p>Solve the model for a (spacially) fixed grid of inputs.</p><p>Parameters:</p><ul><li><code>t_i</code>: start day (w.r.t. t=0 in time)</li><li><code>nd</code>: number of days to run for</li><li><code>a_0</code>: initial area/dm^2</li><li><code>n_0</code>: initial nitrogen reserve/gN/gSW</li><li><code>c_0</code>: initial carbon reserve/gC/gSW</li><li><code>arr_lon</code>: longitudes for no3 and temp</li><li><code>arr_lat</code>: latitudes for no3 and temp</li><li><code>arr_dep</code>: depths for no3 and temp</li><li><code>arr_time</code>: time for no3 and temp</li><li><code>no3</code>: array of no3 concentration in lon,lat,depth,time</li><li><code>temp</code>: array of temp concentration in lon,lat,depth,time</li><li><code>u</code>: array of water speed in lon,lat,depth,time</li><li><code>par_data</code>: array of:<ul><li>`par values in lon,lat,time</li><li>`corresponding time</li><li>`par fill value</li></ul></li><li><code>kd_data</code>: array of:<ul><li>kd values in lon,lat,time</li><li>corresponding time</li><li>kd fill value</li></ul></li><li><code>att</code>: array of light attenuation coefficients (PAR(z)=PAR(z=0)*att) in lon,lat,depth,time. Defaults to nothing and kd is used instead</li><li><code>params</code>: string of the path to a parameters file, defaults to the 2012 values. Also supplied is 2013 in src/parameters/2013.jl or you can copy and vary them</li><li><code>resp_model</code>: choice of respiration model, 1 (default) uses the 2012 version and 2 uses the modifcations from the 2013 paper</li><li><code>dt</code>: the time step size to use (see equations! note), default is 1 day (seems small enough)</li><li><code>progress</code>: option to update progress at each level (when multithreading not accurate but useful), defaults to true</li></ul><p>Returns: results as an array of (area/nitrogen/carbon/nitrate update, lon, lat, depth, time)</p><p>Notes: par and kd need their own time coordinates and fill value because they come from satelite observation which are  temporally sparse so need to be checked and interpolated in time for each point. On the other hand temp and no3 (that I&#39;m using) are from Copurnicus&#39; models so if a point has a value at some time it will at all times.</p><p>no3,temp and u need to be of the same shape and size and with the values corresponding to the same position/time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.solver!-Tuple{Vector{Float64}, Any, Float64}" href="#Main.SugarKelp.solver!-Tuple{Vector{Float64}, Any, Float64}"><code>Main.SugarKelp.solver!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.solver!(y, params, t)</code></pre><p>Interface for OrdinaryDiffEq library, extracts current enviromental variable values and solves equations for each timestep.</p><p>Parameters:</p><ul><li><code>y</code>: the current state of the system as a vector (area, nitrate reserve, carbon reserve).</li><li><code>params</code>: the variable parameters of the model:<ul><li><code>u_arr</code>: interpolation object of the water speed in time</li><li><code>temp_arr</code>: interpolation object of the temperature in time</li><li><code>irr_arr</code>: interpolation object of the irradianec in time</li><li><code>ex_n_arr</code>: interpolation object of the external nitrate concentration in time</li><li><code>λ_arr</code>: array of the normalised change in day length</li><li><code>resp_model</code>: the choice of respiration model, 1 is the origional from the 2012 paper and 2 is the modified version in 2013</li><li><code>dt</code>: the time step length, this is important as it is used in the &quot;extreme carbon limit&quot; part of the equations, see NB.</li></ul></li><li><code>t</code>: the current time (with respect to the time in the interpolations)</li></ul><p>Returns: array of da,dn,dc,j*a - the rate of a/n/c and the nitrate uptake rate</p><p>Note: These equations <strong>must</strong> be solved with an algorithm with fixed time steps and known, constant sub timestep lengths. This is because the &quot;extreme carbon limit&quot; element is only implientable with known and fixed timesteps as the value of a  must be changed to a particular value rather than changing the deriviative. This can only be done (within the framework of the ODE library) by setting the derivitive to (X(next)-X(old))/dt</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Main.SugarKelp.ν-Tuple{Any}" href="#Main.SugarKelp.ν-Tuple{Any}"><code>Main.SugarKelp.ν</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SugarKelp.ν(a)</code></pre><p>Solves Equation 6, the specific frond erosion rate.</p><p>Parameters: <code>a</code>: area /dm^2</p><p>Returns: specific frond erosion rate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jagoosw/SugarKelp.jl">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Index</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.7 on <span class="colophon-date" title="Thursday 7 October 2021 15:54">Thursday 7 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
